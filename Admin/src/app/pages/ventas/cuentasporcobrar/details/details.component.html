<!-- Overlay de carga animado -->
<div *ngIf="mostrarOverlayCarga" class="overlay-carga">
  <div class="typing-indicator">
    <div class="typing-circle"></div>
    <div class="typing-circle"></div>
    <div class="typing-circle"></div>
    <div class="typing-shadow"></div>
    <div class="typing-shadow"></div>
    <div class="typing-shadow"></div>
  </div>
</div>

<div class="card">
  <div class="card-header d-flex justify-content-between align-items-center">
    <h5 class="mb-0">Detalle de Cuenta por Cobrar</h5>
    <button type="button" class="btn btn-secondary btn-sm" (click)="cerrar()">
      <i class="ri-arrow-left-line me-1"></i> Volver
    </button>
  </div>

  <div class="card-body">
    <!-- Alertas -->
    <div class="alert-container">
      <div *ngIf="mostrarAlertaExito" class="alert alert-success alert-dismissible fade show floating-alert">
        <i class="ri-check-double-line me-3 align-middle fs-lg"></i>
        <strong>¡Éxito!</strong> {{ mensajeExito }}
        <button type="button" class="btn-close" (click)="cerrarAlertaExito()"></button>
      </div>

      <div *ngIf="mostrarAlertaError" class="alert alert-danger alert-dismissible fade show floating-alert">
        <i class="ri-error-warning-line me-3 align-middle fs-lg"></i>
        <strong>¡Error!</strong> {{ mensajeError }}
        <button type="button" class="btn-close" (click)="cerrarAlerta()"></button>
      </div>
    </div>

    <!-- Información del detalle -->
    <!-- <div *ngIf="cuentaPorCobrarDetalle" class="mb-4 border rounded p-3 bg-light">
      <h6 class="fw-bold mb-3">Información del Cliente</h6>
      <div class="row">
        <div class="col-md-4"><strong>Cliente:</strong> {{ cuentaPorCobrarDetalle.ClienteNombre || 'N/A' }}</div>
        <div class="col-md-4"><strong>Documento:</strong> {{ cuentaPorCobrarDetalle.Documento || 'N/A' }}</div>
        <div class="col-md-4"><strong>Monto Total:</strong> {{ formatearMoneda(cuentaPorCobrarDetalle.MontoTotal) }}</div>
      </div>
      <div class="row mt-2">
        <div class="col-md-4"><strong>Saldo Pendiente:</strong> {{ formatearMoneda(cuentaPorCobrarDetalle.SaldoPendiente) }}</div>
        <div class="col-md-4"><strong>Fecha Emisión:</strong> {{ formatearFecha(cuentaPorCobrarDetalle.FechaEmision) }}</div>
        <div class="col-md-4"><strong>Vencimiento:</strong> {{ formatearFecha(cuentaPorCobrarDetalle.FechaVencimiento) }}</div>
      </div>
    </div> -->

    <!-- Tabla timeline -->
    <div class="table-radius-container">
      <div class="table-responsive">
        <table class="table table-gridjs table-style">
          <thead>
            <tr>
              <th>Tipo</th>
              <th>Referencia</th>
              <th class="text-end">Monto</th>
              <th>Fecha</th>
              <th>Forma de Pago</th>
              <th>Observaciones</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let item of (table.paginated$ | async) || []">
              <td>{{ item.Tipo }}</td>
              <td>{{ item.Referencia }}</td>
              <td class="text-end">{{ formatearMoneda(item.Monto) }}</td>
              <td>{{ formatearFecha(item.Fecha) }}</td>
              <td>{{ item.FormaPago || 'N/A' }}</td>
              <td>{{ item.CPCo_Observaciones || 'N/A' }}</td>
            </tr>
            <tr *ngIf="(table.paginated$ | async)?.length === 0">
              <td colspan="6" class="text-center text-muted py-3">No hay datos disponibles</td>
            </tr>
          </tbody>
        </table>
      </div>

      <!-- Paginación -->
      <div class="row justify-content-md-between align-items-md-center mt-3" *ngIf="(table.paginated$ | async) as paginados">
        <div class="col-md-5">
          <div class="dataTables_info">
            Mostrando {{ (table.page - 1) * table.pageSizeValue + 1 }} a
            {{ (table.page - 1) * table.pageSizeValue + paginados.length }} de
            {{ table.total$ | async }} registros
          </div>
        </div>
        <div class="col-md-5 text-end">
          <pagination
            [totalItems]="(table.total$ | async) || 0"
            [(ngModel)]="table.page"
            [itemsPerPage]="table.pageSizeValue"
            [maxSize]="5"
            [boundaryLinks]="true"
            [rotate]="true"
            (pageChanged)="table.setPage($event.page)"
            class="pagination-sm">
          </pagination>
        </div>
      </div>
    </div>
  </div>
</div>
